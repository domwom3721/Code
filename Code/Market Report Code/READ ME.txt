This folder contains the set of code files that produce our automated market and submarket reports

The process works as follows:

From CoStar.com, go to Analytics tab ----> Data Export

From the Data Export page:

For Office, Retail, Industrial, and Multifamily:
	- Select the United States
	- Select Base Case
	- Select the time period that ends at the quarter we are doing reports for, and starts at the same quarter 11 years ago.
		-EG: Q1 2010 - Q1 2021
	- Select all markets
	- Select include countries
	- Select include submarkets
	- Unselect exclude markets
	- Select all variables
	- Hit Export
	- Move the "DataExport.CSV" to the data folder
	- Rename either "mf.csv","office.csv","industrial.csv","retail.csv" depending on sector you just downloaded

Once the raw data is downloaded, moved to the data folder, and renamed, run

-1.) Clean Costar Data.py

	- Imports raw data files and cleans and creates new variables for our reports

-Next run 2.)Market Report.py


2.) Market Report.py Summary:
	
	-Imports the 4 cleaned csv files created in 1.) Clean Costar Data.py as pandas (python package) dataframes. 1 for each of the 4 main sectors
	-Loops through the 4 dataframes/sectors and does the following:

		-It then creates a dictionary where each key is a market and each value is a list of the submarkets within that market
		-Loops through each key value pair in the dictionary and does the following:

		
			-It loops through each market and then its submarkets
					-Creates a folder in the directory of the following structure:
						Sector --> State ---> Market ---> Submarket		
					-Creates 3 new dataframes which are slices of the current sector dataframe:
						-1.) Contains data for primary market only
						-2.) Contains data for submarket only
						-3.) Contains data for United States aggregate
					 -Creates png figures with graphs that display data from the dataframes.
					 -Creates word document that reports data on market or submarket. Inserts the png files into it
					 - Saves report document to correct folder
					  

After a few hours, you should have reports in the Market Reports folder under the right folder for each CoStar market and submarket in the United States
for the 4 main sectors

Table_Functions.py, Graph_Functions.py, Language_Functions.py are files that define functions used to create tables and graphs. They are imported in 2.) Market Report.py.
They are stored in seperate files to help keep things organized and readable.
						
		